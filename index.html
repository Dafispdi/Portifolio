<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <title>KyxzanTzy Tools MultiFunction</title>

  <style>
:root {
  --bg1: #0a0f1a;
  --bg2: #0e1524;
  --accent1: #4facfe;
  --accent2: #00f2fe;
  --card: #141e2f;
}

/* ========== GLOBAL ========== */
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, var(--bg1), var(--bg2));
  color: #fff;
  -webkit-font-smoothing: antialiased;
  overflow-x: hidden;
  transition: background 0.4s ease, color 0.4s ease;
}

/* ========== HEADER ========== */
.header {
  width: 100%;
  height: 240px;
  overflow: hidden;
  border-radius: 0 0 25px 25px;
  box-shadow: 0 8px 40px rgba(0, 0, 0, 0.6);
  position: relative;
}
.header img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: brightness(0.6) saturate(1.15);
  transition: filter 0.4s ease;
}
.header::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(1000px 320px at 50% -120px, rgba(79, 172, 254, 0.35), transparent 70%),
              linear-gradient(to bottom, rgba(0, 0, 0, 0.22), rgba(0, 0, 0, 0.8));
}

/* ========== CONTAINER & CARD ========== */
.container {
  max-width: 1000px;
  margin: -80px auto 40px;
  padding: 0 24px;
}
.card {
  background: rgba(10, 18, 32, 0.9);
  border-radius: 20px;
  padding: 28px;
  margin: 28px 0;
  position: relative;
  isolation: isolate;
  box-shadow: 0 8px 28px rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(6px);
  transition: all 0.3s ease;
}
.card::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 20px;
  padding: 0.5px;
  background: linear-gradient(135deg, rgba(79, 172, 254, 0.25), rgba(0, 242, 254, 0.06));
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}
.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 0 60px rgba(0, 255, 255, 0.1);
}

/* ========== TITLES ========== */
h2 {
  margin: 0 0 14px;
  font-size: 1.5rem;
  letter-spacing: 0.6px;
}
h2 i {
  margin-right: 8px;
}

/* ========== MENU ========== */
.menu {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 16px;
}
.menu .menu-item {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  min-height: 60px;
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.015));
  padding: 16px;
  border-radius: 14px;
  text-align: center;
  cursor: pointer;
  font-weight: 600;
  border: 1px solid rgba(255, 255, 255, 0.05);
  transition: all 0.25s ease;
}
.menu .menu-item i {
  font-size: 1.05rem;
  opacity: 0.95;
}
.menu .menu-item:hover {
  transform: translateY(-6px) scale(1.03);
  border-color: rgba(79, 172, 254, 0.35);
  box-shadow: 0 10px 32px rgba(79, 172, 254, 0.18);
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.07), rgba(255, 255, 255, 0.03));
}

/* ========== INPUTS, BUTTONS, PREVIEW, LIGHT THEME, RESPONSIVE omitted for brevity (same as previous version) ========== */
.theme-toggle {
  position: fixed;
  right: 18px;
  bottom: 20px;
  width: 54px;
  height: 54px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.08);
  border: 1px solid rgba(255, 255, 255, 0.15);
  display: grid;
  place-items: center;
  cursor: pointer;
  color: #fff;
  font-size: 1.4rem;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
  transition: all 0.25s ease, transform 0.2s ease;
  backdrop-filter: blur(8px);
  z-index: 99;
}
.theme-toggle:hover {
  transform: translateY(-3px) scale(1.05);
  background: rgba(255, 255, 255, 0.15);
  box-shadow: 0 12px 28px rgba(79, 172, 254, 0.3);
}
.theme-toggle i {
  transition: transform 0.4s ease, opacity 0.4s ease;
}
.theme-toggle i.spin {
  transform: rotate(360deg);
  opacity: 0.85;
}
/* ========== LIGHT THEME OVERRIDES ========== */
body.light{
  color:#0b1220;
  background: linear-gradient(135deg, #f4f7fb, #e9f0f8);
  /* override tokens agar komponen ikut ganti nuansa */
  --bg1:#f6f9ff;
  --bg2:#e9f0f8;
  --accent1:#3b82f6;
  --accent2:#22d3ee;
}

/* surface & card */
body.light .card{
  background: rgba(255,255,255,.92);
  box-shadow: 0 10px 28px rgba(17,24,39,.10);
}

/* tile menu */
body.light .menu .menu-item{
  background: linear-gradient(180deg, rgba(255,255,255,.95), rgba(255,255,255,.88));
  color:#0b1220;
  border-color: rgba(17,24,39,.08);
}
body.light .menu .menu-item:hover{
  border-color: rgba(59,130,246,.35);
  box-shadow: 0 12px 26px rgba(59,130,246,.18);
}

/* form controls */
body.light input,
body.light textarea,
body.light select{
  background:#ffffff !important;
  color:#0b1220 !important;
  border:1px solid rgba(17,24,39,.12) !important;
}
body.light input:focus,
body.light textarea:focus,
body.light select:focus{
  border-color: rgba(59,130,246,.60) !important;
  box-shadow: 0 0 0 4px rgba(59,130,246,.18) !important;
}

/* preview panel */
body.light .preview{
  background:
    radial-gradient(800px 300px at 50% -20%, rgba(59,130,246,.10), transparent 70%),
    #ffffff !important;
  box-shadow: inset 0 0 40px rgba(0,0,0,.05);
}

/* chip download */
body.light .dl{
  background: linear-gradient(180deg, rgba(241,245,249,.95), rgba(226,232,240,.9));
  color:#0b1220;
  border-color: rgba(17,24,39,.08);
}

/* header overlay lebih soft saat terang */
body.light .header::after{
  background:
    radial-gradient(1000px 320px at 50% -120px, rgba(59,130,246,.28), transparent 70%),
    linear-gradient(to bottom, rgba(255,255,255,.22), rgba(255,255,255,0));
}

/* transisi halus ketika ganti tema */
*,
*::before,
*::after{
  transition: background .25s ease, color .25s ease, border-color .25s ease, box-shadow .25s ease;
}
#img2Preview > div {
  animation: fadeIn 0.6s ease forwards;
}
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(10px);}
  to {opacity: 1; transform: translateY(0);}
}
  </style>
</head>

<body>
  <div class="header"><img id="headerImage" alt="header"></div>
  <div class="container">
    <div class="card">
      <h2><i class="fa-solid fa-bolt"></i> Quick Menu</h2>
      <div class="menu">
        <div class="menu-item" onclick="showSection('tiktok')"><i class="fa-solid fa-film"></i> TikTok Downloader</div>
        <div class="menu-item" onclick="showSection('xnxx')"><i class="fa-solid fa-quote-left"></i> Fake XNXX Quote</div>
        <div class="menu-item" onclick="showSection('ektp')"><i class="fa-solid fa-id-card"></i> eKTP Generator</div>
        <div class="menu-item" onclick="showSection('imagine')"><i class="fa-solid fa-wand-magic-sparkles"></i> Imagine</div>
        <div class="menu-item" onclick="showSection('img2prompt')"><i class="fa-solid fa-image"></i> Image to Prompt</div>
        <div class="menu-item" onclick="showSection('tofigure')"><i class="fa-solid fa-person"></i> ToFigure</div>
        <div class="menu-item" onclick="showSection('qr')"><i class="fa-solid fa-qrcode"></i> QR Generator</div>
        <div class="menu-item" onclick="showSection('iqc')"><i class="fa-solid fa-palette"></i> IQC Maker</div>
        <div class="menu-item" onclick="showSection('github')"><i class="fa-brands fa-github"></i> Raw GitHub</div>
        <div class="menu-item" onclick="showSection('skiplink')"><i class="fa-solid fa-link-slash"></i> Bypass Link</div>
        <div class="menu-item" onclick="showSection('about')"><i class="fa-solid fa-user"></i> About</div>
        <div class="menu-item" onclick="showSection('support')"><i class="fa-solid fa-headset"></i> Support</div>
      </div>
    </div>

<!-- TikTok Downloader -->
<div class="card" id="tiktok" style="display:none;">
  <h2><i class="fa-solid fa-film"></i> TikTok Downloader</h2>
  <div class="small">Require: Full TikTok URL (contoh: <code>https://vt.tiktok.com/ZSDQUy2ma/</code>)</div>
  <div class="row" style="margin-top:12px;">
    <input id="tiktokUrl" placeholder="Masukkan URL TikTok..." />
    <button class="btn" onclick="downloadTiktok()">Download</button>
  </div>
  <div class="section-note">Tutor: Paste URL TikTok klik Download hasil akan tampil di bawah. Jika server mengembalikan link file, tombol download akan muncul.</div>
  <div class="preview" id="tiktokPreview"><div class="muted">Hasil akan tampil di sini</div></div>
  <div class="links" id="tiktokLinks" style="display:none;"></div>
</div>

<!-- ToFigure -->
<div class="card" id="tofigure" style="display:none;">
  <h2><i class="fa-solid fa-person"></i> Image → Figure</h2>
  <div class="small">Masukkan URL gambar yang ingin diubah jadi versi figure 3D-style.</div>

  <div class="row" style="margin-top:12px;">
    <input id="figUrl" placeholder="Tempel URL gambar di sini..." />
    <button class="btn" onclick="generateFigure()">Convert</button>
  </div>

  <div class="preview" id="figPreview"><div class="muted">Hasil akan tampil di sini</div></div>
  <div class="links" id="figLinks" style="display:none;"></div>

  <div class="section-note small">
    Tutor: Masukkan URL gambar → klik Convert → tunggu hasil figure muncul.
  </div>
</div>

<!-- XNXX Fake Quotes -->
<div class="card" id="xnxx" style="display:none;">
  <h2><i class="fa-solid fa-quote-left"></i> Fake XNXX Quote</h2>

  <div class="row">
    <input id="xnxxName" placeholder="Masukkan Nama" />
  </div>

  <div class="row">
    <textarea id="xnxxQuote" placeholder="Masukkan Quote..."></textarea>
  </div>

  <div class="row">
    <input id="xnxxLikes" placeholder="Jumlah Likes" type="number" />
    <input id="xnxxDislikes" placeholder="Jumlah Dislikes" type="number" />
  </div>

  <div class="controls">
    <button class="btn" onclick="generateXNXX()">Generate Quote</button>
  </div>

  <div class="preview" id="xnxxPreview">
    <div class="muted">Hasil akan tampil di sini</div>
  </div>

  <div class="links" id="xnxxLinks" style="display:none;"></div>

  <div class="section-note">
    Tutor: Isi Nama, Quote, Likes, Dislikes  klik Generate  hasil berupa gambar fake XNXX akan muncul.
  </div>
</div>

<!-- Image to Prompt -->
<div class="card" id="img2prompt" style="display:none;">
  <h2><i class="fa-solid fa-image"></i> Image → Prompt</h2>
  <div class="small">Masukkan URL gambar untuk dijelaskan jadi teks prompt AI.</div>

  <div class="row" style="margin-top:12px;">
    <input id="img2Url" placeholder="Tempel URL gambar di sini..." />
    <button class="btn" onclick="generatePrompt()">Convert</button>
  </div>

  <div class="preview" id="img2Preview"><div class="muted">Deskripsi hasil akan muncul di sini</div></div>
  <div class="links" id="img2Links" style="display:none;"></div>

  <div class="section-note small">
    Tutor: Paste link gambar → klik Convert → hasil teks prompt akan muncul.
  </div>
</div>

<!-- eKTP Generator (ringkas) -->
<div class="card" id="ektp" style="display:none;">
<h2><i class="fa-solid fa-id-card"></i> eKTP Generator</h2>

  <div class="form-grid">
    <div class="field"><label>NIK</label><input id="e_nik" placeholder="1234567890123456"></div>
    <div class="field"><label>Nama</label><input id="e_nama" placeholder="John Doe"></div>

    <div class="field"><label>TTL</label><input id="e_ttl" placeholder="Bandung, 01-01-1990"></div>
    <div class="field"><label>Jenis Kelamin</label><input id="e_jk" placeholder="Laki-laki / Perempuan"></div>

    <div class="field"><label>Golongan Darah</label><input id="e_goldar" placeholder="A/B/AB/O"></div>
    <div class="field"><label>Agama</label><input id="e_agama" placeholder="Islam"></div>

    <div class="field"><label>Status</label><input id="e_status" placeholder="Belum Kawin"></div>
    <div class="field"><label>Pekerjaan</label><input id="e_pekerjaan" placeholder="Pegawai Swasta"></div>

    <div class="field"><label>Kewarganegaraan</label><input id="e_kwg" placeholder="WNI"></div>
    <div class="field"><label>Masa Berlaku</label><input id="e_berlaku" placeholder="Seumur Hidup"></div>

    <div class="field"><label>Alamat</label><input id="e_alamat" placeholder="Jl. Contoh No. 123"></div>
    <div class="field"><label>Terbuat</label><input id="e_terbuat" placeholder="01-01-2023"></div>

    <div class="field"><label>Kel/Desa</label><input id="e_kel" placeholder="Sukajadi"></div>
    <div class="field"><label>RT/RW</label><input id="e_rtrw" placeholder="001/002"></div>

    <div class="field"><label>Kecamatan</label><input id="e_kec" placeholder="Sukajadi"></div>
    <div class="field"><label>Kota/Kab</label><input id="e_kota" placeholder="BANDUNG"></div>

    <div class="field"><label>Provinsi</label><input id="e_prov" placeholder="Jawa Barat"></div>
    <div class="field"><label>Pas Photo</label><input id="e_foto" type="file" accept="image/*"></div>
  </div>

  <div class="row-gap">
    <button class="btn" onclick="generateEktp()">Generate eKTP</button>
  </div>

  <div class="preview row-gap" id="ektpPreview"><div class="muted">Hasil eKTP akan tampil di sini</div></div>
  <div class="links" id="ektpLinks" style="display:none;"></div>

  <!-- tutor singkat -->
  <div class="section-note row-gap">
    <b>Require:</b> minimal NIK & Nama. Lainnya opsional tapi direkomendasikan.<br>
    <b>Tutor:</b> Isi form → Generate → download gambar eKTP.
  </div>
</div>

<!-- Skiplink/BYPASS -->
<div class="card" id="skiplink" style="display:none;">
<h2><i class="fa-solid fa-link-slash"></i> Bypass / Skip Link</h2>
  <div class="small">Require: Short/redirect URL (contoh: <code>https://bit.ly/xxxx</code>)</div>
  <div class="row" style="margin-top:12px;">
    <input id="skipUrl" placeholder="Masukkan link yang ingin dibypass..." />
    <button class="btn" onclick="bypassLink()">Bypass</button>
  </div>
  <div class="section-note">Tutor: Masukkan link klik Bypass API akan mencoba buka & mengembalikan target akhir. Tidak semua link bisa dibypass jika memakai proteksi.</div>
  <div class="preview" id="skipPreview"><div class="muted">Hasil akan tampil di sini</div></div>
  <div class="links" id="skipLinks" style="display:none;"></div>
</div>

<!-- Imagine (kept) -->
<div class="card" id="imagine" style="display:none;">
  <h2><i class="fa-solid fa-wand-magic-sparkles"></i> Imagine Text-Image</h2>
  <textarea id="imPrompt" placeholder="Tulis prompt gambar..."></textarea>
  <div class="row" style="margin-top:10px;">
    <select id="imStyle"><option value="">Default</option><option value="realistic">Realistic</option><option value="anime">Anime</option><option value="cinematic">Cinematic</option><option value="digital-art">Digital Art</option></select>
    <select id="imAR"><option value="1:1">1:1</option><option value="16:9">16:9</option><option value="9:16">9:16</option><option value="4:3">4:3</option></select>
  </div>
  <div class="controls"><button class="btn" onclick="generateImage()">Generate</button></div>
  <div class="preview" id="imPreview"><div class="muted">Hasil akan tampil di sini</div></div>
  <div class="links" id="imLinks" style="display:none;"></div>
</div>

<!-- Other existing cards (GitHub, QR, IQC, About, Support) -->
<div class="card" id="github" style="display:none;">
<h2><i class="fa-brands fa-github"></i> Raw GitHub Converter</h2>
  <div class="input-box"><input id="githubUrl" placeholder="Paste GitHub URL here..." /><button class="btn" onclick="convertUrl()">Convert</button></div>
  <div class="section-note">Copy raw GitHub file URL untuk langsung di-embed atau fetch.</div>
  <div class="preview" id="githubOut"><div class="muted">Hasil akan tampil di sini</div></div>
</div>

<div class="card" id="qr" style="display:none;">
  <h2><i class="fa-solid fa-qrcode"></i> QR Generator</h2>
  <div class="row"><input id="qrText" placeholder="Enter text / URL..." /><button class="btn" onclick="generateQR()">Generate</button></div>
  <div class="preview" id="qrPreview"><img id="qrImage" src="" style="max-width:240px; border-radius:8px;" /></div>
</div>

<div class="card" id="iqc" style="display:none;">
  <h2><i class="fa-solid fa-palette"></i> IQC Maker</h2>
  <div class="row"><input id="iqcText" placeholder="Masukkan teks..." /><button class="btn" onclick="createIQC()">Create</button></div>
  <div class="preview" id="previewBox"><div class="muted">Hasil akan tampil di sini</div></div>
  <div class="links"><div id="btnDownload" class="dl" style="display:none;" onclick="downloadIQC()">⬇️ Download</div><div id="btnOpen" class="dl" style="display:none;" onclick="openIQC()">🔗 Open</div></div>
</div>

<div class="card" id="about" style="display:none;"><h2><i class="fa-solid fa-user"></i> About Development</h2><p>Created by <b>KyxzanTzy</b><br>UI inspired aesthetic dashboard.<br>Age: 16 | Beginner in JS, HTML, CSS</p></div>

<div class="card" id="support" style="display:none;"><h2><i class="fa-solid fa-headset"></i> Support</h2><p>Dikembang Kan oleh:<br>Telegram: <b>@Kyxsancs</b><br>YouTube: <b>KyxsanGaming</b></p></div>
<div class="card" id="music">
  <h2><i class="fa-solid fa-music"></i> Autoplay Lagu</h2>
  <div class="row">
    <input id="musicUrl" placeholder="Masukkan URL audio (mp3/m4a)..." />
    <button class="btn" onclick="setMusic()">Set & Play</button>
  </div>
  <div class="section-note small">
    Lagu akan auto-play (muted dulu). Klik layar sekali untuk aktifkan suara penuh.
  </div>
</div>

  <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
  <i class="fa-solid fa-sun"></i>
</button>

<script>
	// ===== Autoplay Music =====
function setMusic(){
  const url = document.getElementById('musicUrl').value.trim();
  if(!url){ alert('Masukkan URL audio dulu'); return; }
  localStorage.setItem('autoplay_music_url', url);
  playMusic(url);
}

function playMusic(url){
  let a = document.getElementById('autoplayAudio');
  if(!a){
    a = document.createElement('audio');
    a.id = 'autoplayAudio';
    a.src = url;
    a.autoplay = true;
    a.loop = true;
    a.crossOrigin = "anonymous";

    // ✅ Tambahkan dua baris ini
    a.playsInline = true; // biar bisa auto-play di HP (Safari/Android)
    a.muted = true;       // mulai muted dulu agar izin auto-play gak diblok

    document.body.appendChild(a);
  } else {
    a.src = url;
  }

  // tetap biarkan bagian ini
  a.muted = true;
  a.play().catch(()=>{});
  // setelah interaksi pertama → unmute
  function unlock(){
    a.muted = false;
    a.play().catch(()=>{});
    window.removeEventListener('click',unlock);
    window.removeEventListener('keydown',unlock);
  }
  window.addEventListener('click',unlock);
  window.addEventListener('keydown',unlock);
}

// load otomatis kalau sudah pernah set sebelumnya
document.addEventListener('DOMContentLoaded',()=>{
  const prev = localStorage.getItem('autoplay_music_url');
  if(prev) playMusic(prev);
});

// === THEME TOGGLER (Enhanced with animation) ===
(function(){
  const btn = document.getElementById('themeToggle');
  const KEY = 'kyxzanXsaturn-theme';
  const sysLight = window.matchMedia('(prefers-color-scheme: light)').matches;

  function apply(mode) {
    document.body.classList.toggle('light', mode === 'light');
    btn.innerHTML = mode === 'light'
      ? '<i class="fa-solid fa-moon"></i>'
      : '<i class="fa-solid fa-sun"></i>';
  }

  // ambil mode terakhir atau system default
  const saved = localStorage.getItem(KEY);
  const startMode = saved || (sysLight ? 'light' : 'dark');
  apply(startMode);

  // animasi icon & ganti mode
  btn.addEventListener('click', () => {
    const mode = document.body.classList.contains('light') ? 'dark' : 'light';
    const icon = btn.querySelector('i');
    icon.classList.add('spin'); // efek rotasi
    setTimeout(() => icon.classList.remove('spin'), 400);
    apply(mode);
    localStorage.setItem(KEY, mode);
  });
})();
  
  // header images
  const photos=["https://files.catbox.moe/t2xxcn.jpg","https://files.catbox.moe/wju39l.jpg","https://files.catbox.moe/y95obq.jpg"];
  document.getElementById("headerImage").src=photos[Math.floor(Math.random()*photos.length)];

  function showSection(id){
    document.querySelectorAll('.card[id]').forEach(s=>s.style.display='none');
    document.getElementById(id).style.display='block';
    window.scrollTo({top:0,behavior:'smooth'});
  }
  
async function generateEktp(){
  const pv = document.getElementById("ektpPreview");
  const lk = document.getElementById("ektpLinks");
  pv.innerHTML = '<div class="spinner"></div>'; lk.style.display='none'; lk.innerHTML='';

  const fd = new FormData();
  // wajib
  fd.append('nik',  document.getElementById('e_nik').value.trim());
  fd.append('nama', document.getElementById('e_nama').value.trim());
  // lainnya (ikuti nama field dari curl)
  const get = id => document.getElementById(id).value.trim();
  const opt = (k,v)=>{ if(v) fd.append(k,v); };

  opt('ttl', get('e_ttl'));
  opt('jenis_kelamin', get('e_jk'));
  opt('golongan_darah', get('e_goldar'));
  opt('agama', get('e_agama'));
  opt('status', get('e_status'));
  opt('pekerjaan', get('e_pekerjaan'));
  opt('kewarganegaraan', get('e_kwg'));
  opt('alamat', get('e_alamat'));
  opt('rt/rw', get('e_rtrw'));
  opt('kel/desa', get('e_kel'));
  opt('kecamatan', get('e_kec'));
  opt('kota', get('e_kota'));
  opt('provinsi', get('e_prov'));
  opt('masa_berlaku', get('e_berlaku'));
  opt('terbuat', get('e_terbuat'));

  const foto = document.getElementById('e_foto').files[0];
  if (foto) fd.append('pas_photo', foto, foto.name);

  if(!fd.get('nik') || !fd.get('nama')){
    pv.innerHTML = '<div class="error">Require: NIK dan Nama wajib diisi.</div>'; 
    return;
  }

  try{
    const r = await fetch('https://api.siputzx.my.id/api/m/ektp', { method:'POST', body: fd });
    if(!r.ok) throw new Error('HTTP '+r.status);
    const blob = await r.blob();
    const url = URL.createObjectURL(blob);

    pv.innerHTML = '';
    const img = document.createElement('img'); img.src = url; pv.appendChild(img);

    const d = document.createElement('div');
    d.className = 'dl'; d.innerText = 'Download eKTP';
    d.onclick = ()=>{ const a=document.createElement('a'); a.href=url; a.download='ektp.png'; a.click(); };
    lk.appendChild(d); lk.style.display = 'flex';
  }catch(err){
    const msg = (String(err).includes('Failed to fetch')) 
      ? 'Gagal fetch (kemungkinan CORS). Jalankan via server/proxy.' 
      : err.message;
    pv.innerHTML = '<div class="error">Gagal generate: '+msg+'</div>';
  }
}
// --- ToFigure (Replicate Img2Img) ---
async function generateFigure() {
  const REPLICATE_KEY = "r8_1CPLRSlI2ERdGUlLX1QjmC3vSDPVDCC1yOqo2"; // ganti dengan key kamu sendiri
  const url = document.getElementById('figUrl').value.trim();
  const pv = document.getElementById('figPreview');
  const lk = document.getElementById('figLinks');

  if (!url) {
    alert('Masukkan URL gambar dulu!');
    return;
  }

  pv.innerHTML = '<div class="spinner"></div>';
  lk.style.display = 'none';
  lk.innerHTML = '';

  try {
    // kirim request ke Replicate
    const payload = {
      version: "a9758cb5eaaa06e7ef9ef4a59a4b2b8cd87e5f7cfc81a5f9f4e425c657b91a10", // contoh SDXL img2img
      input: {
        image: url,
        prompt: "3D toy figure version of this image, collectible figurine, realistic lighting, plastic texture, studio render",
        strength: 0.7
      }
    };

    const resp = await fetch("https://api.replicate.com/v1/predictions", {
      method: "POST",
      headers: {
        "Authorization": `Token ${REPLICATE_KEY}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    const pred = await resp.json();
    if (!pred.id) throw new Error(pred.error || "Gagal kirim ke Replicate");

    // cek hasil sampai keluar
    let output = null;
    while (!output) {
      const poll = await fetch(`https://api.replicate.com/v1/predictions/${pred.id}`, {
        headers: { "Authorization": `Token ${REPLICATE_KEY}` }
      });
      const status = await poll.json();
      if (status.status === "succeeded") {
        output = status.output[0];
      } else if (status.status === "failed") {
        throw new Error("Proses gagal di Replicate");
      }
      await new Promise(r => setTimeout(r, 3000)); // delay cek 3 detik
    }

    pv.innerHTML = `
      <div style="display:flex;flex-direction:column;align-items:center;gap:14px;">
        <img src="${output}" alt="Figure Result"
          style="max-width:320px;border-radius:12px;box-shadow:0 8px 22px rgba(0,0,0,0.35);" />
        <div style="font-size:0.9rem;color:#dbeafe;">✅ Generated via Replicate SDXL</div>
      </div>
    `;

    const d = document.createElement('div');
    d.className = 'dl';
    d.innerHTML = '<i class="fa-solid fa-download"></i> Download Figure';
    d.onclick = () => {
      const a = document.createElement('a');
      a.href = output;
      a.download = 'figure_result.png';
      a.click();
    };
    lk.appendChild(d);
    lk.style.display = 'flex';

  } catch (err) {
    pv.innerHTML = `<div class="error">❌ Gagal: ${err.message}</div>`;
  }
}
// --- Fake XNXX Quote ---
async function generateXNXX() {
  const name = document.getElementById('xnxxName').value.trim();
  const quote = document.getElementById('xnxxQuote').value.trim();
  let likes = document.getElementById('xnxxLikes').value.trim();
  let dislikes = document.getElementById('xnxxDislikes').value.trim();

  const pv = document.getElementById('xnxxPreview');
  const lk = document.getElementById('xnxxLinks');

  // validasi wajib
  if (!name || !quote) {
    alert('Require: Nama & Quote harus diisi');
    return;
  }

  // validasi angka likes
  if (!likes) {
    likes = "0";
  } else if (isNaN(likes)) {
    alert("Likes harus berupa angka");
    return;
  }

  // validasi angka dislikes
  if (!dislikes) {
    dislikes = "0";
  } else if (isNaN(dislikes)) {
    alert("Dislikes harus berupa angka");
    return;
  }

  pv.innerHTML = '<div class="spinner"></div>';
  lk.style.display = 'none';
  lk.innerHTML = '';

  try {
    const api = `https://api.siputzx.my.id/api/canvas/fake-xnxx?name=${encodeURIComponent(name)}&quote=${encodeURIComponent(quote)}&likes=${encodeURIComponent(likes)}&dislikes=${encodeURIComponent(dislikes)}`;

    const resp = await fetch(api);
    if (!resp.ok) throw new Error('HTTP ' + resp.status);

    const blob = await resp.blob();
    const url = URL.createObjectURL(blob);

    pv.innerHTML = '';
    const img = document.createElement('img');
    img.src = url;
    pv.appendChild(img);

    const d = document.createElement('div');
d.className = 'dl';
d.innerText = ' Download';
d.style.marginTop = "12px";   // jarak dari gambar
d.onclick = () => {
  const a = document.createElement('a');
  a.href = url;
  a.download = 'xnxx_quote.png';
  a.click();
};

    lk.appendChild(d);
    lk.style.display = 'flex';

  } catch (err) {
    pv.innerHTML = '<div class="error">Error: ' + err.message + '</div>';
  }
}
// --- Image to Prompt (styled version) ---
async function generatePrompt() {
  const url = document.getElementById('img2Url').value.trim();
  const pv = document.getElementById('img2Preview');
  const lk = document.getElementById('img2Links');

  if (!url) {
    alert('Masukkan URL gambar dulu!');
    return;
  }

  pv.innerHTML = '<div class="spinner"></div>';
  lk.style.display = 'none';
  lk.innerHTML = '';

  try {
    const api = 'https://api.sxtream.xyz/ai/image-to-prompt?url=' + encodeURIComponent(url);
    const resp = await fetch(api);
    if (!resp.ok) throw new Error('HTTP ' + resp.status);

    const data = await resp.json();
    let promptText = data.data || data.result || data.description || 'Tidak ada hasil ditemukan';

    // === tampilan hasil keren ===
    pv.innerHTML = `
      <div style="
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: left;
        gap: 14px;
        padding: 16px;
      ">
        <img src="${url}" alt="Preview Image"
          style="max-width: 320px; border-radius: 10px; box-shadow: 0 8px 22px rgba(0,0,0,0.35);" />
        <div style="
          background: rgba(255,255,255,0.05);
          border: 1px solid rgba(255,255,255,0.1);
          padding: 14px 16px;
          border-radius: 10px;
          line-height: 1.6;
          font-size: 0.95rem;
          color: #dbeafe;
          width: 100%;
        ">
          <b style="color:#4facfe;">AI Description:</b><br>
          ${promptText}
        </div>
      </div>
    `;

    // === Tombol Copy ===
    const copyBtn = document.createElement('div');
    copyBtn.className = 'dl';
    copyBtn.innerHTML = '<i class="fa-solid fa-copy"></i> Copy Prompt';
    copyBtn.onclick = () => {
      navigator.clipboard.writeText(promptText);
      copyBtn.innerHTML = '✅ Copied!';
      setTimeout(() => (copyBtn.innerHTML = '<i class="fa-solid fa-copy"></i> Copy Prompt'), 1500);
    };

    lk.innerHTML = '';
    lk.appendChild(copyBtn);
    lk.style.display = 'flex';
  } catch (err) {
    pv.innerHTML = `<div class="error">❌ Gagal memuat hasil: ${err.message}</div>`;
  }
}
// --- TikTok Downloader (robust vt.tiktok shortlink) ---
async function downloadTiktok() {
  const input = document.getElementById('tiktokUrl');
  const preview = document.getElementById('tiktokPreview');
  const links = document.getElementById('tiktokLinks');

  const rawUrl = (input.value || '').trim();
  if (!rawUrl) {
    alert('Masukkan URL TikTok dulu. Contoh: https://vt.tiktok.com/ZSDCECaLw/');
    return;
  }

  // reset UI
  preview.innerHTML = '<div class="spinner"></div>';
  links.style.display = 'none';
  links.innerHTML = '';

  // build endpoint (vt.* harus di-encode)
  const endpoint = 'https://api.siputzx.my.id/api/d/tiktok?url=' + encodeURIComponent(rawUrl);

  try {
    const resp = await fetch(endpoint, { redirect: 'follow' });

    // Kadang API balas video langsung (bukan JSON)
    const ctype = (resp.headers.get('content-type') || '').toLowerCase();
    if (!resp.ok) throw new Error('HTTP ' + resp.status);

    if (!ctype.includes('application/json')) {
      // langsung video => tampilkan tombol open/download
      const blob = await resp.blob();
      const url = URL.createObjectURL(blob);
      preview.innerHTML = '<video controls style="max-width:100%;border-radius:10px;"><source src="' + url + '" type="' + ctype + '"></video>';

      const d = document.createElement('div');
      d.className = 'dl';
      d.innerText = 'Download Video';
      d.onclick = () => { const a = document.createElement('a'); a.href = url; a.download = 'tiktok.mp4'; a.click(); };
      links.appendChild(d);
      links.style.display = 'flex';
      return;
    }

    // Umumnya JSON � bentuk field bisa beda-beda
    const data = await resp.json();

    // helper cari field url terbaik
    const pick = (...cands) => cands.find(u => typeof u === 'string' && u.startsWith('http'));
    // Tambahkan dukungan untuk array data.data.urls
let urlsArr = [];
try {
  urlsArr = Array.isArray(data.data?.urls) ? data.data.urls : [];
} catch {}

const videoNoWM = pick(
  data.nowm, data.no_watermark, data.hdplay, data.play,
  data.play_url, data.url, data?.video?.no_watermark,
  data?.result?.nowm, data?.result?.play,
  data?.data?.nowm, data?.data?.play,
  data?.links?.nowm, data?.download?.nowm,
  urlsArr[0] // ✅ ambil dari array urls jika ada
);
    const videoWM = pick(
      data.watermark, data?.result?.watermark, data?.data?.watermark
    );
    const audioUrl = pick(
      data.audio, data.music, data?.result?.audio, data?.data?.music
    );

    // metadata opsional
    let metaHtml = '<div style="padding:12px;text-align:left;color:#dbeafe">';
    if (data.author || data?.data?.author) metaHtml += '<b>Author:</b> ' + (data.author || data?.data?.author) + '<br>';
    if (data.title || data?.data?.title) metaHtml += '<b>Title:</b> ' + (data.title || data?.data?.title) + '<br>';
    metaHtml += '</div>';
    preview.innerHTML = metaHtml;

    const makeBtn = (label, href, downloadName) => {
      const d = document.createElement('div');
      d.className = 'dl';
      d.innerText = label;
      d.onclick = () => {
        // buka tab baru kalau bukan file langsung
        if (!/(\.mp4|\.m4a|\.mp3)(\?|$)/i.test(href)) {
          window.open(href, '_blank', 'noopener');
          return;
        }
        const a = document.createElement('a');
        a.href = href;
        if (downloadName) a.download = downloadName;
        a.click();
      };
      return d;
    };

    if (videoNoWM) links.appendChild(makeBtn('Download (no watermark)', videoNoWM, 'tiktok_nowm.mp4'));
    if (videoWM)   links.appendChild(makeBtn('Download (watermark)', videoWM, 'tiktok_wm.mp4'));
    if (audioUrl)  links.appendChild(makeBtn('Download Audio', audioUrl, 'tiktok_audio.mp3'));

    if (links.childNodes.length === 0) {
      // tampilkan raw JSON buat debugging kalau tak ada field yang ketemu
      preview.innerHTML += '<div class="small" style="margin-top:10px;color:#ffc">Tidak menemukan link download di response API.</div>' +
                           '<pre style="white-space:pre-wrap;background:#08121a;padding:10px;border-radius:8px;max-height:280px;overflow:auto;">' +
                           JSON.stringify(data, null, 2) + '</pre>';
    } else {
      links.style.display = 'flex';
    }

  } catch (err) {
    const msg = String(err).includes('Failed to fetch')
      ? 'Failed to fetch (kemungkinan CORS). Coba jalankan dari server/proxy.'
      : err.message;
    preview.innerHTML = '<div class="error">Error: ' + msg + '</div>';
  }
}

  // --- Skiplink / Bypass ---
  async function bypassLink(){
    const url=document.getElementById('skipUrl').value.trim();
    const preview=document.getElementById('skipPreview');
    const links=document.getElementById('skipLinks');
    if(!url){ alert('Masukkan link untuk dibypass.'); return; }
    preview.innerHTML='<div class="spinner"></div>';
    links.style.display='none'; links.innerHTML='';
    try{
      const api='https://api.siputzx.my.id/api/tools/skiplink?url='+encodeURIComponent(url);
      const resp=await fetch(api);
      if(!resp.ok) throw new Error('HTTP '+resp.status);
      const data=await resp.json();
      // data might contain target or final_url
      let html = '<div style="padding:12px;text-align:left;color:#dbeafe">';
      if(data.target) html += '<b>Target:</b> '+data.target+'<br>';
      if(data.final_url) html += '<b>Final URL:</b> '+data.final_url+'<br>';
      if(data.message) html += '<b>Message:</b> '+data.message+'<br>';
      html += '</div>';
      preview.innerHTML = html;
      if(data.final_url){ const d=document.createElement('div'); d.className='dl'; d.innerText='Open Final URL'; d.onclick=()=>window.open(data.final_url,'_blank','noopener'); links.appendChild(d); }
      if(links.hasChildNodes()) links.style.display='flex';
    }catch(err){ preview.innerHTML='<div class="error">Error: '+err.message+'</div>'; }
  }

// --- Imagine (updated to Pollinations) ---
async function generateImage() {
  const prompt = document.getElementById('imPrompt').value.trim();
  const style = document.getElementById('imStyle').value;
  const ar = document.getElementById('imAR').value;
  const preview = document.getElementById('imPreview');
  const links = document.getElementById('imLinks');

  if (!prompt) {
    alert('Masukkan prompt!');
    return;
  }

  // Tampilkan spinner loading
  preview.innerHTML = '<div class="spinner"></div>';
  links.style.display = 'none';
  links.innerHTML = '';

  try {
    // Bangun prompt akhir (gabung style & rasio)
    let finalPrompt = prompt;
    if (style) finalPrompt += `, style: ${style}`;
    if (ar) finalPrompt += `, aspect ratio: ${ar}`;

    // Buat URL Pollinations
    const imgUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(finalPrompt)}?model=sdxl`;

    // Bikin elemen gambar
    const img = document.createElement('img');
    img.src = imgUrl;
    img.alt = prompt;
    img.onload = () => {
      preview.innerHTML = '';
      preview.appendChild(img);

      // Tombol download
      const dl = document.createElement('div');
      dl.className = 'dl';
      dl.innerText = 'Download Image';
      dl.onclick = () => {
        const a = document.createElement('a');
        a.href = imgUrl;
        a.download = 'imagine.png';
        a.click();
      };
      links.innerHTML = '';
      links.appendChild(dl);
      links.style.display = 'flex';
    };

    img.onerror = () => {
      preview.innerHTML = '<div class="error">Gagal memuat gambar dari Pollinations.</div>';
    };
  } catch (err) {
    preview.innerHTML = `<div class="error">Gagal generate: ${err.message}</div>`;
  }
}

  // --- GitHub Converter ---
  function convertUrl(){ const input=document.getElementById('githubUrl').value.trim(); const out=document.getElementById('githubOut'); if(!input.includes('github.com')){ out.innerHTML='<div class="error">Invalid GitHub URL.</div>'; return; } const raw=input.replace('github.com','raw.githubusercontent.com').replace('/blob/','/'); out.innerHTML='<div class="small">Raw URL:</div><div style="margin-top:6px;background:#08121a;padding:10px;border-radius:8px;">'+raw+'</div>'; }

  // --- QR ---
  function generateQR(){ const text=document.getElementById('qrText').value.trim(); if(!text) return; document.getElementById('qrImage').src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data='+encodeURIComponent(text); }

  // --- IQC Maker ---
  const API_BASE='https://api.sxtream.xyz/maker/iqc?text='; let lastUrl=null,lastBlob=null; async function createIQC(){ const text=document.getElementById('iqcText').value.trim(); const prev=document.getElementById('previewBox'); const btnD=document.getElementById('btnDownload'); const btnO=document.getElementById('btnOpen'); if(!text) return alert('Masukkan teks dulu!'); prev.innerHTML='<div class="spinner"></div>'; btnD.style.display='none'; btnO.style.display='none'; try{ const resp=await fetch(API_BASE+encodeURIComponent(text)); if(!resp.ok) throw new Error('HTTP '+resp.status); const blob=await resp.blob(); lastBlob=blob; lastUrl=URL.createObjectURL(blob); prev.innerHTML=''; const img=document.createElement('img'); img.src=lastUrl; prev.appendChild(img); btnD.style.display='inline-block'; btnO.style.display='inline-block'; btnD.onclick=()=>{ const a=document.createElement('a'); a.href=lastUrl; a.download='iqc.png'; a.click(); }; btnO.onclick=()=>window.open(lastUrl,'_blank','noopener'); }catch(err){ prev.innerHTML='<div class="error">Gagal memuat hasil.</div>'; } }

  // header init
  document.addEventListener('DOMContentLoaded',()=>{ document.getElementById('headerImage').src=photos[Math.floor(Math.random()*photos.length)]; });

  // initial show menu
  showSection('imagine');
  // ripple klik untuk semua .btn
document.addEventListener('click', (e) => {
  const btn = e.target.closest('.btn');
  if (!btn) return;
  const ripple = document.createElement('span');
  const rect = btn.getBoundingClientRect();
  const size = Math.max(rect.width, rect.height);
  const x = e.clientX - rect.left - size/2;
  const y = e.clientY - rect.top - size/2;
  ripple.style.position = 'absolute';
  ripple.style.left = x + 'px';
  ripple.style.top = y + 'px';
  ripple.style.width = ripple.style.height = size + 'px';
  ripple.style.borderRadius = '50%';
  ripple.style.pointerEvents = 'none';
  ripple.style.background = 'radial-gradient(circle, rgba(255,255,255,.45) 0%, rgba(255,255,255,0) 60%)';
  ripple.style.opacity = '0.6';
  ripple.style.transform = 'scale(0.2)';
  ripple.style.transition = 'transform 450ms ease, opacity 600ms ease';
  btn.appendChild(ripple);
  requestAnimationFrame(() => {
    ripple.style.transform = 'scale(1.6)';
    ripple.style.opacity = '0';
  });
  setTimeout(() => ripple.remove(), 650);
});
</script>
</body>

</html>
